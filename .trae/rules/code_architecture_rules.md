# Code Architecture Guidelines

## Configuration-Driven Development

### 1. Single Source of Truth Principle
- **ä¼˜å…ˆä½¿ç”¨é…ç½®æ–‡ä»¶**ï¼šå¯¹äºä¸šåŠ¡é€»è¾‘ç›¸å…³çš„å¸¸é‡ã€é˜ˆå€¼ã€åˆ†ç±»æ ‡å‡†ï¼Œä¼˜å…ˆè€ƒè™‘åœ¨é…ç½®æ–‡ä»¶ä¸­ç»Ÿä¸€ç®¡ç†
- **å‡å°‘ç¡¬ç¼–ç **ï¼šé¿å…åœ¨ç»„ä»¶ä¸­æ•£å¸ƒä¸šåŠ¡æ•°æ®ï¼Œä½†å…è®¸ç®€å•çš„UIå¸¸é‡ï¼ˆå¦‚åŠ¨ç”»æ—¶é•¿ã€åŸºç¡€æ ·å¼å€¼ï¼‰ç›´æ¥å®šä¹‰
- **é…ç½®èŒè´£è¾¹ç•Œ**ï¼šé…ç½®æ–‡ä»¶ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘æ•°æ®ï¼ŒUIæ ·å¼å’Œäº¤äº’é€»è¾‘ä¿ç•™åœ¨ç»„ä»¶ä¸­
- **ä¾‹å¤–æƒ…å†µ**ï¼šå¯¹äºä¸€æ¬¡æ€§ä½¿ç”¨ã€é«˜åº¦ç‰¹å®šçš„æ•°æ®ï¼Œå¯ä»¥è€ƒè™‘å°±è¿‘å®šä¹‰

### 2. Data Consistency Guidelines
- **è¯†åˆ«é‡å¤æ¨¡å¼**ï¼šå½“åŒä¸€æ•°æ®åœ¨å¤šå¤„ä½¿ç”¨æ—¶ï¼Œè€ƒè™‘æå–åˆ°é…ç½®ä¸­
- **å¹³è¡¡åŠ¨æ€æ€§ä¸æ€§èƒ½**ï¼šå¤æ‚è®¡ç®—å¯ä»¥é¢„è®¡ç®—å¹¶ç¼“å­˜ï¼Œç®€å•æ˜ å°„å¯ä»¥åŠ¨æ€ç”Ÿæˆ
- **æ¸è¿›å¼é‡æ„**ï¼šå¯¹äºç°æœ‰ä»£ç ï¼Œå¯ä»¥é€æ­¥å°†é‡å¤çš„ä¸šåŠ¡æ•°æ®è¿ç§»åˆ°é…ç½®ä¸­

## Component Design Principles

### 3. Component Abstraction Balance
- **é€‚åº¦æŠ½è±¡**ï¼šåœ¨å¤ç”¨æ€§å’Œç‰¹å®šæ€§ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ï¼Œé¿å…è¿‡åº¦é€šç”¨åŒ–å¯¼è‡´çš„å¤æ‚æ€§
- **ä¸šåŠ¡å¯¼å‘**ï¼šä¼˜å…ˆè€ƒè™‘ä¸šåŠ¡åœºæ™¯çš„ç‰¹æ®Šæ€§ï¼Œå½“ä¸šåŠ¡é€»è¾‘å·®å¼‚è¾ƒå¤§æ—¶ï¼Œå€¾å‘äºåˆ›å»ºä¸“é—¨ç»„ä»¶
- **æ¸è¿›å¼æŠ½è±¡**ï¼šä»å…·ä½“å®ç°å¼€å§‹ï¼Œå½“å‘ç°é‡å¤æ¨¡å¼æ—¶å†è€ƒè™‘æŠ½è±¡
- **ç±»å‹å®‰å…¨**ï¼šä½¿ç”¨TypeScriptç¡®ä¿ç»„ä»¶æ¥å£çš„æ¸…æ™°æ€§å’Œå®‰å…¨æ€§

### 4. Separation of Concerns Guidelines
- **æ˜ç¡®è¾¹ç•Œ**ï¼šé…ç½®ç®¡ç†ä¸šåŠ¡è§„åˆ™ï¼Œç»„ä»¶ç®¡ç†å±•ç¤ºé€»è¾‘ï¼Œä½†å…è®¸åˆç†çš„è€¦åˆ
- **å°±è¿‘åŸåˆ™**ï¼šç›¸å…³çš„é€»è¾‘å°½é‡æ”¾åœ¨ä¸€èµ·ï¼Œé¿å…è¿‡åº¦åˆ†æ•£
- **æ€§èƒ½è€ƒè™‘**ï¼šå¤æ‚è®¡ç®—å¯ä»¥æŠ½å–ï¼Œä½†ç®€å•é€»è¾‘å¯ä»¥å†…è”ä»¥æé«˜å¯è¯»æ€§

## Code Organization

### 5. File Structure Guidelines
- **é€»è¾‘åˆ†ç»„**ï¼šæŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡æ–‡ä»¶ï¼Œç›¸å…³çš„é…ç½®ã€ç»„ä»¶ã€å·¥å…·å‡½æ•°æ”¾åœ¨ä¸€èµ·
- **é…ç½®å°±è¿‘åŸåˆ™**ï¼šé…ç½®æ–‡ä»¶å¯ä»¥æ”¾åœ¨ä½¿ç”¨å®ƒçš„ç»„ä»¶é™„è¿‘ï¼Œä¹Ÿå¯ä»¥ç»Ÿä¸€ç®¡ç†ï¼Œæ ¹æ®é¡¹ç›®è§„æ¨¡å†³å®š
- **ç±»å‹å®šä¹‰ç­–ç•¥**ï¼šç®€å•ç±»å‹å¯ä»¥å†…è”å®šä¹‰ï¼Œå¤æ‚ç±»å‹è€ƒè™‘å•ç‹¬æ–‡ä»¶æˆ–ä¸ç›¸å…³é€»è¾‘æ”¾åœ¨ä¸€èµ·

### 6. Naming Conventions
- **ä¸€è‡´æ€§ä¼˜å…ˆ**ï¼šåœ¨é¡¹ç›®å†…ä¿æŒå‘½åé£æ ¼çš„ä¸€è‡´æ€§
- **è¯­ä¹‰æ¸…æ™°**ï¼šåç§°åº”è¯¥æ¸…æ¥šè¡¨è¾¾å…¶ç”¨é€”å’Œå«ä¹‰
- **é€‚åº¦æè¿°æ€§**ï¼šé¿å…è¿‡é•¿çš„åç§°ï¼Œä½†è¦è¶³å¤Ÿæè¿°æ€§

## Data Flow

### 7. Configuration Usage Patterns
- **ç›´æ¥è®¿é—® vs å°è£…**ï¼šç®€å•çš„é…ç½®è®¿é—®å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå¤æ‚çš„ä¸šåŠ¡é€»è¾‘è€ƒè™‘å°è£…
- **æ€§èƒ½æƒè¡¡**ï¼šé¢‘ç¹è®¿é—®çš„æ•°æ®å¯ä»¥è€ƒè™‘ç¼“å­˜æˆ–é¢„å¤„ç†
- **é”™è¯¯å¤„ç†**ï¼šå¯¹é…ç½®æ•°æ®è¿›è¡Œé€‚å½“çš„éªŒè¯å’Œé”™è¯¯å¤„ç†

### 8. Algorithm Design Principles
- **å¯è¯»æ€§ä¼˜å…ˆ**ï¼šç®—æ³•åº”è¯¥æ˜“äºç†è§£å’Œç»´æŠ¤
- **é…ç½®é©±åŠ¨ vs æ€§èƒ½**ï¼šåœ¨é…ç½®çµæ´»æ€§å’Œæ‰§è¡Œæ€§èƒ½ä¹‹é—´æ‰¾åˆ°å¹³è¡¡
- **è¾¹ç•Œå¤„ç†**ï¼šæ˜ç¡®å¤„ç†è¾¹ç•Œæƒ…å†µå’Œå¼‚å¸¸è¾“å…¥

## Maintainability

### 9. Code Evolution Strategy
- **è¯†åˆ«é‡å¤æ¨¡å¼**ï¼šå½“å‘ç°ç›¸ä¼¼çš„ä»£ç æ¨¡å¼æ—¶ï¼Œè¯„ä¼°æŠ½è±¡çš„æˆæœ¬å’Œæ”¶ç›Š
- **é‡æ„æ—¶æœº**ï¼šåŸºäº"ä¸‰æ¬¡æ³•åˆ™"ï¼Œä½†ä¹Ÿè¦è€ƒè™‘ä¸šåŠ¡å¤æ‚åº¦å’Œå˜åŒ–é¢‘ç‡
- **æ¸è¿›å¼æ”¹è¿›**ï¼šä¼˜å…ˆè§£å†³å½“å‰ç—›ç‚¹ï¼Œé¿å…è¿‡åº¦è®¾è®¡

### 10. Quality Assurance
- **å…³é”®è·¯å¾„æµ‹è¯•**ï¼šé‡ç‚¹æµ‹è¯•æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å’Œç”¨æˆ·å…³é”®æµç¨‹
- **é…ç½®éªŒè¯**ï¼šç¡®ä¿é…ç½®æ•°æ®çš„æ­£ç¡®æ€§ï¼Œç‰¹åˆ«æ˜¯è¾¹ç•Œå€¼
- **å›å½’æµ‹è¯•**ï¼šé‡æ„åç¡®ä¿åŠŸèƒ½ä¸å—å½±å“

## Best Practices Summary

### âœ… æ¨èåšæ³•

```typescript
// é…ç½®é©±åŠ¨ï¼Œä½†ä¿æŒç®€æ´
const labels = CI_CLASSIFICATION_CONFIG.ranges.map(range => range.label);

// ç®—æ³•åŸºäºé…ç½®ï¼Œä½†ä¼˜å…ˆå¯è¯»æ€§
function calculatePosition(value: number, ranges: ClassificationRange[]) {
  // æ¸…æ™°çš„é€»è¾‘ï¼Œé€‚å½“çš„æ³¨é‡Š
}

// ä¸“é—¨åŒ–ç»„ä»¶ï¼Œæ˜ç¡®èŒè´£
function CICard({ value }: { value: number }) {
  // ä¸“æ³¨äºCIå±•ç¤ºé€»è¾‘
}
```

### âš ï¸ éœ€è¦æƒè¡¡çš„æƒ…å†µ

- **æ€§èƒ½ vs çµæ´»æ€§**ï¼šé«˜é¢‘è°ƒç”¨çš„å‡½æ•°å¯ä»¥é€‚åº¦ä¼˜åŒ–
- **å¤ç”¨ vs ç®€æ´**ï¼šç®€å•åœºæ™¯ä¸å¿…è¿‡åº¦æŠ½è±¡
- **é…ç½® vs ç¡¬ç¼–ç **ï¼šç¨³å®šä¸å˜çš„å¸¸é‡å¯ä»¥ç¡¬ç¼–ç 

### ğŸ¯ æ ¸å¿ƒåŸåˆ™

1. **å¯è¯»æ€§ç¬¬ä¸€**ï¼šä»£ç åº”è¯¥æ˜“äºç†è§£å’Œç»´æŠ¤
2. **é€‚åº¦æŠ½è±¡**ï¼šåœ¨å¤ç”¨æ€§å’Œå¤æ‚æ€§ä¹‹é—´æ‰¾åˆ°å¹³è¡¡
3. **ä¸šåŠ¡å¯¼å‘**ï¼šæŠ€æœ¯å†³ç­–åº”è¯¥æœåŠ¡äºä¸šåŠ¡éœ€æ±‚
4. **æ¸è¿›å¼æ”¹è¿›**ï¼šæŒç»­ä¼˜åŒ–ï¼Œé¿å…ä¸€æ¬¡æ€§å¤§é‡æ„

## Examples

### å®é™…åº”ç”¨ç¤ºä¾‹

**é…ç½®é©±åŠ¨çš„åˆ†ç±»ï¼š**
```typescript
// é…ç½®å®šä¹‰
export const CI_CLASSIFICATION_CONFIG: ClassificationConfig = {
  name: 'CI',
  unit: '',
  ranges: [
    { min: 0, max: 75, severity: 'normal', label: 'æ­£å¸¸' },
    { min: 75, max: 85, severity: 'mild', label: 'è½»åº¦' },
    { min: 85, max: 95, severity: 'moderate', label: 'ä¸­åº¦' },
    { min: 95, max: Infinity, severity: 'severe', label: 'é‡åº¦' }
  ]
};

// ä½¿ç”¨é…ç½®çš„åˆ†ç±»å‡½æ•°
function classifyCI(value: number) {
  return classifyByConfig(value, CI_CLASSIFICATION_CONFIG);
}
```

**ä¸“é—¨åŒ–ç»„ä»¶è®¾è®¡ï¼š**
```typescript
function CICard({ value }: { value: number }) {
  const classification = classifyCI(value);
  const labels = CI_CLASSIFICATION_CONFIG.ranges.map(range => range.label);
  
  return (
    <div className="ci-card">
      {/* CIç‰¹æœ‰çš„å±•ç¤ºé€»è¾‘ */}
      <CIVisualization value={value} ranges={CI_CLASSIFICATION_CONFIG.ranges} />
      <CIFormula />
      <CIAnnotations />
    </div>
  );
}
```

**å¹³è¡¡çš„ç®—æ³•è®¾è®¡ï¼š**
```typescript
// é…ç½®é©±åŠ¨ï¼Œä½†ä¿æŒå¯è¯»æ€§
function calculatePosition(value: number, ranges: ClassificationRange[]) {
  for (let i = 0; i < ranges.length; i++) {
    const range = ranges[i];
    if (value >= range.min && value < range.max) {
      // åœ¨å½“å‰èŒƒå›´å†…è®¡ç®—ç›¸å¯¹ä½ç½®
      const rangeWidth = range.max === Infinity ? 20 : range.max - range.min;
      const relativePosition = (value - range.min) / rangeWidth;
      return (i * 25) + (relativePosition * 25); // æ¯ä¸ªèŒƒå›´å 25%å®½åº¦
    }
  }
  return 100; // è¶…å‡ºèŒƒå›´æ—¶çš„é»˜è®¤ä½ç½®
}
```

### å…³é”®æ”¶ç›Š

1. **é…ç½®ä¸€è‡´æ€§**ï¼šé¿å…ç¡¬ç¼–ç å¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´
2. **ä¸“é—¨åŒ–è®¾è®¡**ï¼šæ¯ä¸ªç»„ä»¶ä¸“æ³¨äºç‰¹å®šä¸šåŠ¡åœºæ™¯
3. **å¯ç»´æŠ¤æ€§**ï¼šä¿®æ”¹ä¸šåŠ¡è§„åˆ™æ—¶å½±å“èŒƒå›´å¯æ§
4. **ç±»å‹å®‰å…¨**ï¼šTypeScriptæä¾›ç¼–è¯‘æ—¶æ£€æŸ¥
5. **æ¸è¿›å¼ä¼˜åŒ–**ï¼šå¯ä»¥é€æ­¥æ”¹è¿›è€Œä¸å½±å“æ•´ä½“æ¶æ„

## Summary

è¿™ä»½æŒ‡å—çš„æ ¸å¿ƒç†å¿µæ˜¯åœ¨**çµæ´»æ€§**å’Œ**å®ç”¨æ€§**ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ï¼š

### ğŸ¯ æ ¸å¿ƒä»·å€¼è§‚

1. **å¯è¯»æ€§ä¼˜å…ˆ**ï¼šä»£ç åº”è¯¥æ˜“äºç†è§£ï¼Œå³ä½¿ç‰ºç‰²ä¸€äº›"å®Œç¾"çš„æŠ½è±¡
2. **é€‚åº¦é…ç½®é©±åŠ¨**ï¼šåœ¨é…ç½®çµæ´»æ€§å’Œä»£ç ç®€æ´æ€§ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ç‚¹
3. **æ¸è¿›å¼æ”¹è¿›**ï¼šä»å…·ä½“å®ç°å¼€å§‹ï¼Œå‘ç°æ¨¡å¼åå†æŠ½è±¡
4. **ä¸šåŠ¡å¯¼å‘**ï¼šæŠ€æœ¯å†³ç­–åº”è¯¥æœåŠ¡äºä¸šåŠ¡éœ€æ±‚å’Œå›¢é˜Ÿæ•ˆç‡

### ğŸ“‹ å®è·µè¦ç‚¹

- **é…ç½®ä½¿ç”¨**ï¼šç®€å•è®¿é—®ç›´æ¥ä½¿ç”¨ï¼Œå¤æ‚é€»è¾‘é€‚å½“å°è£…
- **ç»„ä»¶è®¾è®¡**ï¼šä¸“é—¨åŒ– vs é€šç”¨åŒ–æ ¹æ®ä¸šåŠ¡å¤æ‚åº¦å†³å®š
- **ä»£ç ç»„ç»‡**ï¼šé€»è¾‘åˆ†ç»„ï¼Œå°±è¿‘åŸåˆ™ï¼Œé¿å…è¿‡åº¦åˆ†æ•£
- **é‡æ„æ—¶æœº**ï¼šåŸºäºå®é™…ç—›ç‚¹ï¼Œè€Œéç†è®ºå®Œç¾

### ğŸš€ é¢„æœŸæ”¶ç›Š

- **ç»´æŠ¤æ•ˆç‡**ï¼šä¿®æ”¹å½±å“èŒƒå›´å¯æ§ï¼Œå®šä½é—®é¢˜å¿«é€Ÿ
- **å¼€å‘ä½“éªŒ**ï¼šç±»å‹å®‰å…¨ï¼ŒIDEæ”¯æŒè‰¯å¥½
- **å›¢é˜Ÿåä½œ**ï¼šä»£ç é£æ ¼ä¸€è‡´ï¼Œæ–°äººå®¹æ˜“ä¸Šæ‰‹
- **ä¸šåŠ¡é€‚åº”**ï¼šèƒ½å¤Ÿå¿«é€Ÿå“åº”ä¸šåŠ¡éœ€æ±‚å˜åŒ–

è®°ä½ï¼š**å¥½çš„æ¶æ„æ˜¯æ¼”è¿›å‡ºæ¥çš„ï¼Œä¸æ˜¯è®¾è®¡å‡ºæ¥çš„**ã€‚ä»ç®€å•å¼€å§‹ï¼ŒæŒç»­æ”¹è¿›ã€‚